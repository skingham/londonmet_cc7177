
% Outline

% introduce EDRs and how they are used to protect organisations

% introduce process injection attacks: MITRE, and NT process attacks

% how do EDRs

\section{Proess Injection Attack and EDR Repsonse Primer}


Terminology \ldots Host-based code injection attack (HBCIA) techniques \autocite{Barabosch:2014} continue to evolve since a method to map an external module into a target process by Microsoft \autocite{Ghizzoni:2004} was published, to support applications such as ``anti-virus programs, profilers, debuggers, and pseudo-localization testing'', and quickly used by malicious actors to insert DLLs into target processes \autocite{Jang:2007}.

Recently a new host-base code injection (HBCI) method targeting the code sections with Read Write eXecute (RWX)  \textit{(include more detail here)} was identified by researchers \autocite{Peixoto:2023}.  This report is a review of this technique and an overview of this class of attacks.


End-point Detection and Response Systems (EDR) have developed to counter these myriad threats.  These systems are gaining in sophistication and adversaries
are on the hunt for new ways to evade these systems.

In this report we look at a new variation of one attack technique, process injection, and ask how EDRs protect against these attacks and how
this new technique would evade those barriers.  In particular we are looking at the ``Mockingjay'' attach that targets modern Windows machines.

EDRs incorporate protections of increasing levels of sophistication.

At the first level there are static monitoring of specific machine DLLs and processes to detect changes.  Making sure that certain subsystems
have not been modified, had elevated permissions, or unknown processes running on the monitored system.  Signature based

Next, user and entity behaviour analytics (EUBA) tools identify changes in behaviours that could indicate a threat.  This could include the
applications and systems a user normally uses, looking for configuration changes, and scanning log files for changes in behaviour.

Statistical modeling will profile normal activity and continuous monitoring will attempt to descern anomolous behaviour as a threat occurs.

Anomaly detection can be prone to false positives.  The threat actor will look for attacks that could look like inocent behavior.

These protections can be signatu



\subsection{Endpoint Security: EDR}

% \href{https://www.crowdstrike.com/cybersecurity-101/endpoint-security/edr-vs-mdr-vs-xdr/}{EDR vs MDR vs XDR}
HBCI techniques work on injecting code into running processes and having that code executed as part of the normal process
execution.  End-point Detection and Response (EDR) systems \autocite{Hayes:2023} provides realtime visibiluty

Process injection seeks bypass EDR hooks by injecting code into trusted processes with RWX permissions already set.

\subsection{Code Injection Methods}

Talk about Mitre process injection tech T1055 \autocite{Mitre:2017}

\subsubsection{Deploying Payload into Windows Memory Space}

% \href{https://modexp.wordpress.com/2018/07/15/process-injection-sharing-payload/}{Process injection sharing payload}

\autocite{Zhan:2018}

\href{https://www.riskinsight-wavestone.com/en/2023/10/process-injection-using-ntsetinformationprocess/}{PI using NTSetInformationProcess}

\href{https://github.com/elddy/Windows-NTAPI-Injector}{NTAPI injector} 

\href{https://gist.github.com/WKL-Sec/96e17188e4c159c2cdf7ff2c111130cc#file-local-c}{Injector examples in C}

\href{https://www.unknowncheats.me/forum/anti-cheat-bypass/286274-internal-detection-vectors-bypass.html}{internal detection vectors bypass}

\href{https://medium.com/@s12deff/process-injection-with-random-rwx-memory-spaces-3e3651149527}{PI with random RWX memory spaces}
